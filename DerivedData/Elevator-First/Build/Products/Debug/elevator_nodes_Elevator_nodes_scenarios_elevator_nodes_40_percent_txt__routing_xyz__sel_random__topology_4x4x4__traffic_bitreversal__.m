% fname: elevator_nodes_Elevator_nodes_scenarios_elevator_nodes_40_percent_txt__routing_xyz__sel_random__topology_4x4x4__traffic_bitreversal__.m
% ./Elevator-First -elevator_nodes Elevator_nodes_scenarios/elevator_nodes_40_percent.txt -routing xyz -sel random -dimx 4 -dimy 4 -traffic bitreversal  -sim 10000 -warmup 1000 -size 8 8 -buffer 4 

function [max_pir, max_throughput, min_delay] = elevator_nodes_Elevator_nodes_scenarios_elevator_nodes_40_percent_txt__routing_xyz__sel_random__topology_4x4x4__traffic_bitreversal__(symbol)

data = [
%             pir      avg_delay     throughput      max_delay   total_energy       rpackets         rflits
            0.005        13.2296      0.0345655            168    6.39073e-07           2426          17421
            0.005         12.998      0.0349127            106    6.37221e-07           2444          17596
            0.005        13.3846      0.0357143             96    6.62178e-07           2501          18000
            0.005        13.1353      0.0356488             98    6.53116e-07           2491          17967
            0.005        13.1881      0.0352222            107    6.34572e-07           2478          17752
            0.005        13.0491      0.0354087             96    6.49739e-07           2487          17846
            0.005        12.8913      0.0338552             93    6.16803e-07           2374          17063
            0.005        13.7369      0.0370357            105    6.78421e-07           2588          18666
            0.005        13.4062      0.0371607            120    6.84035e-07           2592          18729
            0.005        12.5639      0.0338929             83     6.2337e-07           2380          17082
           0.0055        14.0033      0.0394583            131    7.31252e-07           2762          19887
           0.0055        14.0237       0.039746            139     7.2588e-07           2781          20032
           0.0055        13.5909      0.0378849            155    6.82067e-07           2640          19094
           0.0055         13.613      0.0400575            165    7.43415e-07           2806          20189
           0.0055        13.5146      0.0383671            129    7.06111e-07           2678          19337
           0.0055        13.3416      0.0383194             80    7.05662e-07           2676          19313
           0.0055        13.5803       0.039623             90    7.31155e-07           2766          19970
           0.0055         13.936      0.0393889            203    7.23275e-07           2752          19852
           0.0055        13.3646      0.0391488            101    7.10976e-07           2732          19731
           0.0055        13.3237      0.0383333            118    7.05552e-07           2697          19320
            0.006        15.1015      0.0441389            229     8.1396e-07           3065          22246
            0.006        14.5361      0.0434087             90    7.98902e-07           3018          21878
            0.006        14.9597      0.0424127            220    7.71872e-07           2953          21376
            0.006        14.7313      0.0431389            177    7.89368e-07           2992          21742
            0.006        14.3213      0.0424563            101    7.74207e-07           2960          21398
            0.006        14.2972      0.0441925            120     8.1172e-07           3075          22273
            0.006        14.0779      0.0423413            101    7.80636e-07           2952          21340
            0.006        14.9357      0.0420754            136    7.77572e-07           2938          21206
            0.006         14.805      0.0420635            120    7.83286e-07           2933          21200
            0.006         14.347      0.0423849            108     7.7645e-07           2954          21362
           0.0065        15.3602      0.0465179            162    8.50638e-07           3226          23445
           0.0065        16.1635      0.0457698            221    8.35221e-07           3180          23068
           0.0065        15.5037      0.0468413            223    8.61916e-07           3242          23608
           0.0065        15.2785       0.046121            277    8.42073e-07           3214          23245
           0.0065        15.1952      0.0464762            186    8.55151e-07           3227          23424
           0.0065         14.948      0.0458988            144     8.4565e-07           3194          23133
           0.0065        14.8001      0.0457401            142    8.37901e-07           3182          23053
           0.0065        14.9865       0.048129            109    8.82895e-07           3329          24257
           0.0065        14.8646      0.0468968            230    8.48051e-07           3257          23636
           0.0065        15.3714      0.0465496            121    8.51313e-07           3239          23461
            0.007        16.4472      0.0506548            234    9.30899e-07           3511          25530
            0.007        15.8259      0.0490615            130    8.99002e-07           3401          24727
            0.007        16.9217      0.0509583            249    9.23768e-07           3527          25683
            0.007          15.24      0.0488155            170    9.00665e-07           3396          24603
            0.007        15.3271      0.0496488            170    9.07605e-07           3430          25023
            0.007         15.165      0.0502599            183    9.04652e-07           3491          25331
            0.007        15.6905      0.0491508            211    9.02358e-07           3428          24772
            0.007        16.0408      0.0499861            165    9.00401e-07           3460          25193
            0.007        16.1966      0.0506151            252    9.14662e-07           3500          25510
            0.007        15.9767      0.0500496            268    9.02007e-07           3477          25225
           0.0075         17.264       0.054373            194    9.89181e-07           3773          27404
           0.0075        16.7347      0.0544921            262    9.96711e-07           3773          27464
           0.0075        17.3372      0.0543433            214    9.93502e-07           3763          27389
           0.0075        16.8174      0.0540853            219    9.86143e-07           3730          27259
           0.0075        17.2479      0.0547718            246     9.8988e-07           3796          27605
           0.0075        17.4629       0.053494            258    9.76054e-07           3690          26961
           0.0075        17.1821       0.053006            308     9.6452e-07           3673          26715
           0.0075        18.4066      0.0549187            312    9.98714e-07           3785          27679
           0.0075        16.6342      0.0537044            226    9.69997e-07           3712          27067
           0.0075        16.8003      0.0543631            207    9.89371e-07           3755          27399
            0.008        17.2808      0.0565972            154    1.03336e-06           3910          28525
            0.008        18.0769      0.0560754            235    1.03597e-06           3877          28262
            0.008        19.6362      0.0569187            391    1.02998e-06           3923          28687
            0.008        17.6303      0.0579444            268    1.04692e-06           3990          29204
            0.008        18.5438       0.058381            204    1.06513e-06           4014          29424
            0.008        19.9087       0.058369            431    1.04658e-06           4020          29418
            0.008        19.2003      0.0590575            408    1.07639e-06           4059          29765
            0.008        19.2271      0.0587282            455    1.06627e-06           4043          29599
            0.008         17.995      0.0556607            188    1.01311e-06           3831          28053
            0.008        20.5421      0.0567302            431    1.02427e-06           3892          28592
           0.0085        20.2456      0.0618413            392    1.13685e-06           4267          31168
           0.0085        21.8988       0.061504            417     1.0996e-06           4231          30998
           0.0085        20.0864      0.0605119            323    1.10124e-06           4142          30498
           0.0085        19.6052      0.0599802            301    1.10259e-06           4116          30230
           0.0085        20.7536      0.0618611            615    1.10785e-06           4249          31178
           0.0085        18.7361      0.0603373            283    1.08856e-06           4150          30410
           0.0085         18.303      0.0589504            324    1.07255e-06           4082          29711
           0.0085        19.0933      0.0604067            302    1.09015e-06           4149          30445
           0.0085        20.4452      0.0609048            530    1.10756e-06           4185          30696
           0.0085        19.4643      0.0595377            377    1.08679e-06           4094          30007
            0.009        22.3517      0.0645655            326    1.16511e-06           4427          32541
            0.009        20.8866      0.0657004            398    1.16438e-06           4472          33113
            0.009        21.3865      0.0644087            453    1.16606e-06           4409          32462
            0.009        22.2946      0.0654782            576    1.17611e-06           4498          33001
            0.009        20.9559      0.0645794            484    1.14532e-06           4423          32548
            0.009        23.8661      0.0653016            510    1.16785e-06           4473          32912
            0.009        21.1169      0.0639643            431    1.15776e-06           4387          32238
            0.009        23.8141      0.0640992            442    1.16072e-06           4406          32306
            0.009        22.8607      0.0645516            430    1.15052e-06           4408          32534
            0.009        21.4216      0.0654444            287    1.18471e-06           4485          32984
           0.0095        23.1598      0.0668968            424    1.19977e-06           4592          33716
           0.0095        25.1947       0.068123            550    1.24035e-06           4644          34334
           0.0095         27.025      0.0679683            574    1.21766e-06           4634          34256
           0.0095        22.6813       0.066879            548    1.18663e-06           4562          33707
           0.0095         27.007       0.068498            575     1.2317e-06           4683          34523
           0.0095        31.0206      0.0684405            783     1.2418e-06           4669          34494
           0.0095        26.4098      0.0685813            715    1.22864e-06           4683          34565
           0.0095        23.9196      0.0679167            371    1.21179e-06           4652          34230
           0.0095        22.3673      0.0676071            365    1.22134e-06           4620          34074
           0.0095        22.1271      0.0669821            422    1.21718e-06           4579          33759
             0.01        29.6776      0.0704683            911    1.27384e-06           4811          35516
             0.01        42.9577      0.0728571           1208    1.31134e-06           4946          36720
             0.01        34.8955       0.073629            822    1.30808e-06           4986          37109
             0.01         27.263      0.0715536            650    1.28808e-06           4874          36063
             0.01        30.1734      0.0716964            751    1.28722e-06           4874          36135
             0.01         33.228      0.0718452           1042    1.28945e-06           4859          36210
             0.01        32.7802      0.0708075            767    1.26923e-06           4822          35687
             0.01        35.6952      0.0727341           1090    1.30717e-06           4937          36658
             0.01        30.7085       0.072131            588    1.29409e-06           4903          36354
             0.01        39.6102      0.0731925           1282     1.3198e-06           4962          36889
           0.0105        39.5417      0.0756706            771     1.3668e-06           5112          38138
           0.0105        52.9211      0.0768373           1903    1.36457e-06           5224          38726
           0.0105        35.7987      0.0750159           1455    1.33474e-06           5081          37808
           0.0105        47.4394       0.075123           2260    1.34318e-06           5077          37862
           0.0105        48.1134      0.0761667           1330     1.3541e-06           5160          38388
           0.0105        62.0014      0.0766865           1584    1.36549e-06           5182          38650
           0.0105        53.3966      0.0746984           1546     1.3428e-06           5068          37648
           0.0105        43.0582      0.0749583           1032    1.34118e-06           5065          37779
           0.0105        51.0112      0.0753631           1399    1.35273e-06           5093          37983
           0.0105         61.438      0.0753909           1855    1.36443e-06           5103          37997
            0.011        90.5251      0.0802282           2941    1.42655e-06           5391          40435
            0.011        73.8244      0.0792857           2674    1.40599e-06           5363          39960
            0.011        79.0473      0.0784127           1998    1.40922e-06           5260          39520
            0.011        61.5531      0.0792877           1616    1.41182e-06           5337          39961
            0.011         57.103      0.0813135           1775    1.44485e-06           5483          40982
            0.011        47.3496      0.0804623           1053    1.42908e-06           5415          40553
            0.011        55.9326       0.082244           1237    1.45113e-06           5545          41451
            0.011        62.2128      0.0791647           2407     1.4083e-06           5347          39899
            0.011        66.8906      0.0794623           1433    1.42149e-06           5358          40049
            0.011        60.4508      0.0800159           1807    1.42302e-06           5370          40328
           0.0115        72.2265       0.083625           1948    1.46937e-06           5606          42147
           0.0115        113.012      0.0811905           3524    1.46792e-06           5452          40920
           0.0115        65.7461      0.0817143           1397    1.46564e-06           5503          41184
           0.0115         78.915      0.0829187           2769    1.48867e-06           5544          41791
           0.0115        94.5984      0.0820198           3459    1.46904e-06           5535          41338
           0.0115        83.6792      0.0827004           2319    1.46329e-06           5540          41681
           0.0115        79.9939      0.0819901           2232    1.47317e-06           5531          41323
           0.0115        117.294      0.0823948           3218    1.46351e-06           5559          41527
           0.0115         87.937       0.081627           5496    1.44158e-06           5489          41140
           0.0115        99.0773      0.0814921           2878    1.45464e-06           5486          41072
            0.012        121.162      0.0854266           3424    1.50651e-06           5755          43055
            0.012          111.1      0.0853651           4346    1.51916e-06           5733          43024
            0.012        70.6221      0.0853155           2538    1.48086e-06           5713          42999
            0.012        102.662       0.086502           3155    1.52782e-06           5804          43597
            0.012        90.9627      0.0875536           2529    1.52662e-06           5869          44127
            0.012        87.4268      0.0870437           2938    1.53775e-06           5850          43870
            0.012        105.056      0.0853671           4087    1.50005e-06           5732          43025
            0.012        91.0758      0.0850417           3530    1.50918e-06           5714          42861
            0.012        121.735       0.085252           2923    1.49621e-06           5724          42967
            0.012        136.984      0.0857857           5181    1.50709e-06           5746          43236
           0.0125        118.564      0.0889187           4225    1.55792e-06           5963          44815
           0.0125        141.554      0.0877996           5543    1.55801e-06           5881          44251
           0.0125        114.049      0.0889802           4382     1.5658e-06           5938          44846
           0.0125        118.774      0.0895496           2839    1.58059e-06           5975          45133
           0.0125        134.023      0.0895476           4198     1.5813e-06           5963          45132
           0.0125        117.987      0.0873115           4069    1.54617e-06           5852          44005
           0.0125        117.021      0.0893194           3512    1.56904e-06           5979          45017
           0.0125        144.128      0.0899385           5608    1.58499e-06           6011          45329
           0.0125        145.253       0.088756           5903    1.55512e-06           5918          44733
           0.0125         85.502      0.0910595           3561    1.60789e-06           6103          45894
];

rows = size(data, 1);
cols = size(data, 2);

data_delay = [];
for i = 1:rows/10,
   ifirst = (i - 1) * 10 + 1;
   ilast  = ifirst + 10 - 1;
   tmp = data(ifirst:ilast, cols-6+1);
   avg = mean(tmp);
   [h sig ci] = ttest(tmp, 0.1);
   ci = (ci(2)-ci(1))/2;
   data_delay = [data_delay; data(ifirst, 1:cols-6), avg ci];
end

figure(1);
hold on;
plot(data_delay(:,1), data_delay(:,2), symbol);

data_throughput = [];
for i = 1:rows/10,
   ifirst = (i - 1) * 10 + 1;
   ilast  = ifirst + 10 - 1;
   tmp = data(ifirst:ilast, cols-6+2);
   avg = mean(tmp);
   [h sig ci] = ttest(tmp, 0.1);
   ci = (ci(2)-ci(1))/2;
   data_throughput = [data_throughput; data(ifirst, 1:cols-6), avg ci];
end

figure(2);
hold on;
plot(data_throughput(:,1), data_throughput(:,2), symbol);

data_maxdelay = [];
for i = 1:rows/10,
   ifirst = (i - 1) * 10 + 1;
   ilast  = ifirst + 10 - 1;
   tmp = data(ifirst:ilast, cols-6+3);
   avg = mean(tmp);
   [h sig ci] = ttest(tmp, 0.1);
   ci = (ci(2)-ci(1))/2;
   data_maxdelay = [data_maxdelay; data(ifirst, 1:cols-6), avg ci];
end

figure(3);
hold on;
plot(data_maxdelay(:,1), data_maxdelay(:,2), symbol);

data_totalenergy = [];
for i = 1:rows/10,
   ifirst = (i - 1) * 10 + 1;
   ilast  = ifirst + 10 - 1;
   tmp = data(ifirst:ilast, cols-6+4);
   avg = mean(tmp);
   [h sig ci] = ttest(tmp, 0.1);
   ci = (ci(2)-ci(1))/2;
   data_totalenergy = [data_totalenergy; data(ifirst, 1:cols-6), avg ci];
end

figure(4);
hold on;
plot(data_totalenergy(:,1), data_totalenergy(:,2), symbol);


%-------- Saturation Analysis -----------
slope=[];
for i=2:size(data_throughput,1),
    slope(i-1) = (data_throughput(i,2)-data_throughput(i-1,2))/(data_throughput(i,1)-data_throughput(i-1,1));
end

for i=2:size(slope,2),
    if slope(i) < (0.95*mean(slope(1:i)))
        max_pir = data_throughput(i, 1);
        max_throughput = data_throughput(i, 2);
        min_delay = data_delay(i, 2);
        break;
    end
end
